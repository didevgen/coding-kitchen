{"remainingRequest":"/Users/ykova/mine/coding-kitchen/node_modules/ts-loader/index.js??ref--16-1!/Users/ykova/mine/coding-kitchen/packages/web/src/components/Favorite.tsx","dependencies":[{"path":"/Users/ykova/mine/coding-kitchen/packages/web/src/components/Favorite.tsx","mtime":1637790000135},{"path":"/Users/ykova/mine/coding-kitchen/node_modules/cache-loader/dist/cjs.js","mtime":1637425226491},{"path":"/Users/ykova/mine/coding-kitchen/node_modules/ts-loader/index.js","mtime":1637425227303}],"contextDependencies":[],"result":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useMutation } from '@apollo/client';\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport IconButton from '@mui/material/IconButton';\nimport { LIKE_POST } from '../graphql/mutations/post';\nimport { GET_USER_INFO } from '../graphql/queries/userQuery';\nexport function Favorite(_a) {\n    var _this = this;\n    var post = _a.post;\n    var like = useMutation(LIKE_POST)[0];\n    return (_jsx(IconButton, __assign({ color: post.isLiked ? 'secondary' : 'default', \"aria-label\": \"add to favorites\", onClick: function () { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4, like({\n                            variables: {\n                                postId: post.id,\n                                isLiked: !post.isLiked\n                            },\n                            update: function (proxy) {\n                                var data = proxy.readQuery({ query: GET_USER_INFO });\n                                proxy.writeQuery({\n                                    query: GET_USER_INFO,\n                                    data: __assign(__assign({}, data), { posts: data.posts.map(function (cachedPost) {\n                                            if (cachedPost.id === post.id) {\n                                                return __assign(__assign({}, cachedPost), { isLiked: !post.isLiked });\n                                            }\n                                            return cachedPost;\n                                        }) })\n                                });\n                            }\n                        })];\n                    case 1:\n                        _a.sent();\n                        return [2];\n                }\n            });\n        }); } }, { children: _jsx(FavoriteIcon, {}, void 0) }), void 0));\n}\n",{"version":3,"file":"/Users/ykova/mine/coding-kitchen/packages/web/src/components/Favorite.tsx","sourceRoot":"","sources":["/Users/ykova/mine/coding-kitchen/packages/web/src/components/Favorite.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAE,WAAW,EAAE,MAAM,gBAAgB,CAAC;AAC7C,OAAO,YAAY,MAAM,8BAA8B,CAAC;AACxD,OAAO,UAAU,MAAM,0BAA0B,CAAC;AAClD,OAAO,EAAE,SAAS,EAAE,MAAM,2BAA2B,CAAC;AACtD,OAAO,EAAE,aAAa,EAAE,MAAM,8BAA8B,CAAC;AAE7D,MAAM,UAAU,QAAQ,CAAC,EAAQ;IAAjC,iBAwCC;QAxC0B,IAAI,UAAA;IACtB,IAAA,IAAI,GAAI,WAAW,CAAC,SAAS,CAAC,GAA1B,CAA2B;IACtC,OAAO,CACL,KAAC,UAAU,aACT,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,SAAS,gBAClC,kBAAkB,EAC7B,OAAO,EAAE;;;4BACP,WAAM,IAAI,CAAC;4BACT,SAAS,EAAE;gCACT,MAAM,EAAE,IAAI,CAAC,EAAE;gCACf,OAAO,EAAE,CAAC,IAAI,CAAC,OAAO;6BACvB;4BACD,MAAM,EAAE,UAAA,KAAK;gCAEX,IAAM,IAAI,GAAQ,KAAK,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,aAAa,EAAE,CAAC,CAAC;gCAE5D,KAAK,CAAC,UAAU,CAAC;oCACf,KAAK,EAAE,aAAa;oCACpB,IAAI,wBAEC,IAAI,KACP,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,UAAU;4CAC9B,IAAI,UAAU,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,EAAE;gDAC7B,6BACK,UAAU,KACb,OAAO,EAAE,CAAC,IAAI,CAAC,OAAO,IACtB;6CACH;4CAED,OAAO,UAAU,CAAC;wCACpB,CAAC,CAAC,GACH;iCACF,CAAC,CAAC;4BACL,CAAC;yBACF,CAAC,EAAA;;wBA3BF,SA2BE,CAAC;;;;aACJ,gBAED,KAAC,YAAY,aAAG,YACL,CACd,CAAC;AACJ,CAAC","sourcesContent":["import { useMutation } from '@apollo/client';\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport IconButton from '@mui/material/IconButton';\nimport { LIKE_POST } from '../graphql/mutations/post';\nimport { GET_USER_INFO } from '../graphql/queries/userQuery';\n\nexport function Favorite({ post }) {\n  const [like] = useMutation(LIKE_POST);\n  return (\n    <IconButton\n      color={post.isLiked ? 'secondary' : 'default'}\n      aria-label=\"add to favorites\"\n      onClick={async () => {\n        await like({\n          variables: {\n            postId: post.id,\n            isLiked: !post.isLiked\n          },\n          update: proxy => {\n            // Read the data from our cache for this query.\n            const data: any = proxy.readQuery({ query: GET_USER_INFO });\n            // Write our data back to the cache with the new comment in it\n            proxy.writeQuery({\n              query: GET_USER_INFO,\n              data: {\n                // @ts-ignore\n                ...data,\n                posts: data.posts.map(cachedPost => {\n                  if (cachedPost.id === post.id) {\n                    return {\n                      ...cachedPost,\n                      isLiked: !post.isLiked\n                    };\n                  }\n\n                  return cachedPost;\n                })\n              }\n            });\n          }\n        });\n      }}\n    >\n      <FavoriteIcon />\n    </IconButton>\n  );\n}\n"]}]}