{"remainingRequest":"/Users/ykova/mine/coding-kitchen/node_modules/ts-loader/index.js??ref--16-1!/Users/ykova/mine/coding-kitchen/packages/web/src/components/PhotoDialog/PhotoDialog.tsx","dependencies":[{"path":"/Users/ykova/mine/coding-kitchen/packages/web/src/components/PhotoDialog/PhotoDialog.tsx","mtime":1637785884484},{"path":"/Users/ykova/mine/coding-kitchen/node_modules/cache-loader/dist/cjs.js","mtime":1637425226491},{"path":"/Users/ykova/mine/coding-kitchen/node_modules/ts-loader/index.js","mtime":1637425227303}],"contextDependencies":[],"result":["var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useMutation } from '@apollo/client';\nimport { Button, Dialog, DialogActions, DialogContent, DialogTitle, TextField } from '@mui/material';\nimport { Fragment, useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport { CREATE_POST } from '../../graphql/mutations/post';\nimport { StyledDropzone } from './Dropzone';\nvar EditorContainer = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  display: flex;\\n  justify-content: center;\\n  flex-direction: column;\\n\"], [\"\\n  display: flex;\\n  justify-content: center;\\n  flex-direction: column;\\n\"])));\nvar ImageContainer = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  max-width: 720px;\\n  align-self: center;\\n\"], [\"\\n  max-width: 720px;\\n  align-self: center;\\n\"])));\nvar StyledImage = styled.img(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  max-width: 100%;\\n\"], [\"\\n  max-width: 100%;\\n\"])));\nvar ButtonContainer = styled.div(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n\"], [\"\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n\"])));\nexport function NewPhoto(_a) {\n    var uuid = _a.uuid;\n    var _b = useState(false), open = _b[0], setOpen = _b[1];\n    return (_jsxs(ButtonContainer, { children: [_jsx(Button, __assign({ onClick: function () {\n                    setOpen(true);\n                } }, { children: \"Create Post\" }), void 0), _jsx(PhotoDialog, { setOpen: setOpen, open: open, params: { uuid: uuid } }, void 0)] }, void 0));\n}\nexport function PhotoDialog(_a) {\n    var _this = this;\n    var setOpen = _a.setOpen, open = _a.open, params = _a.params, downloadLink = _a.downloadLink, ratio = _a.ratio;\n    var createPost = useMutation(CREATE_POST)[0];\n    var _b = useState(null), image = _b[0], setImage = _b[1];\n    var _c = useState(''), name = _c[0], setName = _c[1];\n    var _d = useState(downloadLink), previewUrl = _d[0], setPreviewUrl = _d[1];\n    useEffect(function () {\n        if (open) {\n            setPreviewUrl(downloadLink);\n        }\n    }, [open]);\n    var handleClose = function () {\n        setTimeout(function () {\n            setImage(undefined);\n            setPreviewUrl(undefined);\n        }, 200);\n        setName(null);\n        setOpen(false);\n    };\n    var handleDrop = function (dropped) {\n        setImage(dropped);\n        var reader = new FileReader();\n        reader.readAsDataURL(dropped);\n        reader.onloadend = function (e) {\n            setPreviewUrl(reader.result);\n        };\n    };\n    var onSave = function () { return __awaiter(_this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, createPost({\n                        variables: {\n                            postData: {\n                                description: name\n                            },\n                            image: image\n                        }\n                    })];\n                case 1:\n                    _a.sent();\n                    handleClose();\n                    return [2];\n            }\n        });\n    }); };\n    return (_jsxs(Dialog, __assign({ open: open, \"aria-labelledby\": \"form-dialog-title\", fullWidth: true, maxWidth: 'md' }, { children: [_jsx(DialogTitle, __assign({ id: \"form-dialog-title\" }, { children: \"Add image\" }), void 0), _jsxs(DialogContent, { children: [!previewUrl && _jsx(StyledDropzone, { onDrop: handleDrop, ratio: ratio }, void 0), previewUrl && (_jsx(Fragment, { children: _jsxs(EditorContainer, { children: [_jsx(ImageContainer, { children: _jsx(StyledImage, { src: previewUrl }, void 0) }, void 0), _jsx(\"div\", { children: _jsx(TextField, { label: \"Description\", margin: \"normal\", multiline: true, rows: 3, value: name, onChange: function (e) {\n                                            setName(e.target.value);\n                                        }, fullWidth: true, variant: \"outlined\" }, void 0) }, void 0)] }, void 0) }, void 0))] }, void 0), _jsxs(DialogActions, { children: [_jsx(Button, __assign({ onClick: handleClose, color: \"primary\" }, { children: \"Cancel\" }), void 0), _jsx(Button, __assign({ variant: \"contained\", disabled: !image || !name, onClick: onSave, color: \"primary\" }, { children: \"Save\" }), void 0)] }, void 0)] }), void 0));\n}\nvar templateObject_1, templateObject_2, templateObject_3, templateObject_4;\n",{"version":3,"file":"/Users/ykova/mine/coding-kitchen/packages/web/src/components/PhotoDialog/PhotoDialog.tsx","sourceRoot":"","sources":["/Users/ykova/mine/coding-kitchen/packages/web/src/components/PhotoDialog/PhotoDialog.tsx"],"names":[],"mappings":"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","sourcesContent":["// @ts-ignore\nimport { useMutation } from '@apollo/client';\nimport { Button, Dialog, DialogActions, DialogContent, DialogTitle, TextField } from '@mui/material';\nimport { Fragment, useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport { CREATE_POST } from '../../graphql/mutations/post';\nimport { StyledDropzone } from './Dropzone';\n\nconst EditorContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n`;\n\nexport interface ImageDialogProps {\n  setOpen: (state: boolean) => void;\n  open: boolean;\n  downloadLink?: string;\n  ratio?: string[];\n  params: {\n    uuid: string;\n  };\n}\n\nconst ImageContainer = styled.div`\n  max-width: 720px;\n  align-self: center;\n`;\nconst StyledImage = styled.img`\n  max-width: 100%;\n`;\n\nconst ButtonContainer = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nexport function NewPhoto({ uuid }) {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <ButtonContainer>\n      <Button\n        onClick={() => {\n          setOpen(true);\n        }}\n      >\n        Create Post\n      </Button>\n      <PhotoDialog setOpen={setOpen} open={open} params={{ uuid }} />\n    </ButtonContainer>\n  );\n}\n\nexport function PhotoDialog({ setOpen, open, params, downloadLink, ratio }: ImageDialogProps) {\n  const [createPost] = useMutation(CREATE_POST);\n  const [image, setImage] = useState<any>(null);\n  const [name, setName] = useState<any>('');\n  const [previewUrl, setPreviewUrl] = useState(downloadLink);\n\n  useEffect(() => {\n    if (open) {\n      setPreviewUrl(downloadLink);\n    }\n    // eslint-disable-next-line\n  }, [open]);\n  const handleClose = () => {\n    setTimeout(() => {\n      setImage(undefined);\n      setPreviewUrl(undefined);\n    }, 200);\n    setName(null);\n    setOpen(false);\n  };\n\n  const handleDrop = (dropped: any) => {\n    setImage(dropped);\n    const reader = new FileReader();\n    reader.readAsDataURL(dropped);\n\n    reader.onloadend = e => {\n      setPreviewUrl(reader.result as string);\n    };\n  };\n\n  const onSave = async () => {\n    await createPost({\n      variables: {\n        postData: {\n          description: name\n        },\n        image\n      }\n    });\n    handleClose();\n  };\n  return (\n    <Dialog open={open} aria-labelledby=\"form-dialog-title\" fullWidth={true} maxWidth={'md'}>\n      <DialogTitle id=\"form-dialog-title\">Add image</DialogTitle>\n      <DialogContent>\n        {!previewUrl && <StyledDropzone onDrop={handleDrop} ratio={ratio} />}\n        {previewUrl && (\n          <Fragment>\n            <EditorContainer>\n              <ImageContainer>\n                <StyledImage src={previewUrl} />\n              </ImageContainer>\n              <div>\n                <TextField\n                  label=\"Description\"\n                  margin=\"normal\"\n                  multiline\n                  rows={3}\n                  value={name}\n                  onChange={e => {\n                    setName(e.target.value);\n                  }}\n                  fullWidth={true}\n                  variant=\"outlined\"\n                />\n              </div>\n            </EditorContainer>\n          </Fragment>\n        )}\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose} color=\"primary\">\n          Cancel\n        </Button>\n        <Button variant=\"contained\" disabled={!image || !name} onClick={onSave} color=\"primary\">\n          Save\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n"]}]}